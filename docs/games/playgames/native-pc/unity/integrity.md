---
title: https://developer.android.com/games/playgames/native-pc/unity/integrity
url: https://developer.android.com/games/playgames/native-pc/unity/integrity
source: md.txt
---

The Play Integrity API protects your game from risky and fraudulent interactions
with an integrity verdict token that you verify on your backend server.

**Namespace:** `PlayPcSdkManaged.Integrity`

**Client Class:** `IntegrityClient`

## Create the client

Use the factory to create the `IntegrityClient`. The factory registers
Unity-specific callbacks and disposes of the client when the script is
destroyed.

```c#
using UnityEngine;
using System;
using System.Threading.Tasks;
// Required SDK Namespaces
using PlayPcSdkManaged.Integrity;
using PlayPcSdkManaged.Unity;

public class IntegrityManager : MonoBehaviour
{
    private IntegrityClient _integrityClient;

    public void SetupIntegrity()
    {
        try
        {
            // Creates the client with the required UnityIntegrityCallbacksHandler
            _integrityClient = PlayPcSdkFactory.CreateIntegrityClient();
            Debug.Log("Integrity Client created successfully.");
        }
        catch (Exception ex)
        {
            Debug.LogError($"Failed to create Integrity Client: {ex.Message}");
        }
    }

    private void OnDestroy()
    {
        // Always dispose of the client
        _integrityClient?.Dispose();
    }
}
```

## Request an integrity token

Requesting an integrity token is a two-step process:

- **Prepare.** Warms up the integrity service and generates a session ID.

- **Request.** Uses the session ID from the preparation step to request the
  actual signed token.

```c#
public async Task RequestIntegrityTokenAsync()
{
    try
    {
        // Replace with your actual Google Cloud Project Number
        long myCloudProjectNumber = 123456789;

        // ---
        // Step 1: Prepare the Token
        // ---
        var prepareParams = new PrepareIntegrityTokenParams
        {
            CloudProjectNumber = myCloudProjectNumber
        };

        Debug.Log("Preparing Integrity Token...");
        var prepareResult = await _integrityClient.PrepareIntegrityTokenAsync(prepareParams);

        if (!prepareResult.IsOk)
        {
            Debug.LogError($"Prepare Failed: {prepareResult.Code} - {prepareResult.ErrorMessage}");
            return;
        }

        // ---
        // Step 2: Request the Token
        // ---
        // You must use the RequestTokenData returned from the prepare step
        var requestParams = new RequestIntegrityTokenParams
        {
            RequestTokenData = prepareResult.Value.RequestTokenData,

            // A nonce to bind this token to a specific request or action.
            // This should be generated by your backend server.
            RequestHash = "your_secure_nonce_string"
        };

        Debug.Log("Requesting Integrity Token...");
        var tokenResult = await _integrityClient.RequestIntegrityTokenAsync(requestParams);

        if (tokenResult.IsOk)
        {
            // The TokenBytes is already a string (Base64 URL-safe web token)
            string signedToken = tokenResult.Value.TokenBytes;

            Debug.Log("Integrity Token Received. Sending to backend for verification...");

            // Send 'signedToken' to your backend server for verification
        }
        else
        {
            Debug.LogError($"Request Failed: {tokenResult.Code} - {tokenResult.ErrorMessage}");
        }
    }
    catch (Exception ex)
    {
        Debug.LogException(ex);
    }
}
```